/*! Tink v0.5.7 */angular.module("tink.dateHelper",[]),angular.module("tink.dateHelper").factory("dateParser",function(){function stringToDate(_date,_format){var _delimiter;-1!==_format.indexOf("/")?_delimiter="/":-1!==_format.indexOf("-")?_delimiter="-":-1!==_format.indexOf(".")&&(_delimiter=".");var formatLowerCase=_format.toLowerCase(),formatItems=formatLowerCase.split(_delimiter),dateItems=_date.split(_delimiter),monthIndex=formatItems.indexOf("mm"),dayIndex=formatItems.indexOf("dd"),yearIndex=formatItems.indexOf("yyyy"),month=parseInt(dateItems[monthIndex]);month-=1;var formatedDate=new Date(dateItems[yearIndex],month,dateItems[dayIndex]);return formatedDate}var nl={DAY:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],MONTH:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],SHORTDAY:["zo","ma","di","wo","do","vr","za"],SHORTMONTH:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."]},dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){for(val=String(val),len=len||2;val.length<len;)val="0"+val;return val};return function(date,mask,utc,lang){var dF=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(date)||/\d/.test(date)||(mask=date,date=void 0),date=date?new Date(date):new Date,isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]).toLowerCase(),"UTC:"==mask.slice(0,4)&&(mask=mask.slice(4),utc=!0);var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:lang.SHORTDAY[D],dddd:lang.DAY[D],m:m+1,mm:pad(m+1),mmm:lang.SHORTMONTH[m],mmmm:lang.MONTH[m],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:12>H?"a":"p",tt:12>H?"am":"pm",T:12>H?"A":"P",TT:12>H?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(100*Math.floor(Math.abs(o)/60)+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();return dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"d/m/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},{dateBeforeOther:function(first,last){return new Date(first).getTime()>new Date(last).getTime()?!0:!1},splitRow:function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},daysBetween:function(first,last){return Math.round(Math.abs((first.getTime()-last.getTime())/864e5))},isSameDate:function(a,b){return angular.isDate(a)&&angular.isDate(b)?(a.setHours(0,0,0,0),b.setHours(0,0,0,0),a.getTime()===b.getTime()):!1},isSameMonth:function(a,b){return angular.isDate(a)&&angular.isDate(b)?(a.setHours(0,0,0,0),b.setHours(0,0,0,0),a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()):!1},getDate:function(date,format){return stringToDate(date,format)},daysInMonth:function(date){return new Date(date.getYear(),date.getMonth()+1,0).getDate()},format:function(date,format){return dateFormat(date,format,null,nl)},getShortDays:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.SHORTDAY}},getShortMonths:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.SHORTMONTH}},getDays:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.DAY}},getMonths:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.MONTH}}}}).factory("calView",function(dateParser){function isSameDate(a,b){return angular.isDate(a)&&angular.isDate(b)?(a.setHours(0,0,0,0),b.setHours(0,0,0,0),a.getTime()===b.getTime()):!1}function inRange(date,first,last){return angular.isDate(first)&&angular.isDate(last)&&angular.isDate(date)?(date.setHours(0,0,0,0),first.setHours(0,0,0,0),last.setHours(0,0,0,0),date>first&&last>date?!0:!1):!1}function mod(n,m){var mod=(n%m+m)%m;return mod}function callCullateData(date){var year=date.getFullYear(),month=date.getMonth(),firstDayOfMonth=new Date(year,month,1),firstDayOfWeek=new Date(+firstDayOfMonth-864e5*mod(firstDayOfMonth.getDay()-1,7)),offsetDayOfMonth=firstDayOfMonth.getTimezoneOffset(),offsetDayOfweek=firstDayOfWeek.getTimezoneOffset();offsetDayOfMonth!==offsetDayOfweek&&(firstDayOfWeek=new Date(+firstDayOfWeek+6e4*(offsetDayOfweek-offsetDayOfMonth)));var daysToDraw=dateParser.daysInMonth(date)+dateParser.daysBetween(firstDayOfWeek,firstDayOfMonth);return daysToDraw%7!==0&&(daysToDraw+=7-daysToDraw%7),{days:daysToDraw,firstDay:firstDayOfWeek}}function createLabels(date,firstRange,lastRange){var label="",cssClass="";return null!==label&&angular.isDate(date)?(label=date.getDate(),isSameDate(date,firstRange)||isSameDate(date,lastRange)?cssClass="btn-primary":inRange(date,firstRange,lastRange)?cssClass="btn-info":isSameDate(date,new Date)&&(cssClass="btn-warning"),"<td><button ng-click=\"$select('"+date.getFullYear()+"/"+(date.getMonth()+1)+"/"+date.getDate()+'\')" class="'+cssClass+'"><span>'+label+"</span></button></td>"):"<td></td>"}return{createMonthDays:function(date,firstRange,lastRange){for(var label,domElem="",monthCall=callCullateData(date),tr="<tr>",i=0;i<monthCall.days;i++){var day=new Date(monthCall.firstDay.getFullYear(),monthCall.firstDay.getMonth(),monthCall.firstDay.getDate()+i);label=day.getMonth()!==date.getMonth()?createLabels(null):createLabels(day,firstRange,lastRange),tr+=label,(i+1)%7===0&&(tr+="</tr>",domElem+=tr,tr="<tr>")}return domElem='<tbody id="secondCal">'+domElem+"</tbody>"}}}),angular.module("tink.datepicker",["tink.dateHelper","tink.safeApply"]).factory("dimensions",function(){var fn=(angular.element,{}),nodeName=fn.nodeName=function(element,name){return element.nodeName&&element.nodeName.toLowerCase()===name.toLowerCase()};fn.css=function(element,prop,extra){var value;return value=element.currentStyle?element.currentStyle[prop]:window.getComputedStyle?window.getComputedStyle(element)[prop]:element.style[prop],extra===!0?parseFloat(value)||0:value},fn.offset=function(element){var boxRect=element.getBoundingClientRect(),docElement=element.ownerDocument;return{width:boxRect.width||element.offsetWidth,height:boxRect.height||element.offsetHeight,top:boxRect.top+(window.pageYOffset||docElement.documentElement.scrollTop)-(docElement.documentElement.clientTop||0),left:boxRect.left+(window.pageXOffset||docElement.documentElement.scrollLeft)-(docElement.documentElement.clientLeft||0)}},fn.position=function(element){var offsetParentElement,offset,offsetParentRect={top:0,left:0};return"fixed"===fn.css(element,"position")?offset=element.getBoundingClientRect():(offsetParentElement=offsetParent(element),offset=fn.offset(element),nodeName(offsetParentElement,"html")||(offsetParentRect=fn.offset(offsetParentElement)),offsetParentRect.top+=fn.css(offsetParentElement,"borderTopWidth",!0),offsetParentRect.left+=fn.css(offsetParentElement,"borderLeftWidth",!0)),{width:element.offsetWidth,height:element.offsetHeight,top:offset.top-offsetParentRect.top-fn.css(element,"marginTop",!0),left:offset.left-offsetParentRect.left-fn.css(element,"marginLeft",!0)}};var offsetParent=function(element){var docElement=element.ownerDocument,offsetParent=element.offsetParent||docElement;if(nodeName(offsetParent,"#document"))return docElement.documentElement;for(;offsetParent&&!nodeName(offsetParent,"html")&&"static"===fn.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElement.documentElement};return fn.height=function(element,outer){var value=element.offsetHeight;return outer?value+=fn.css(element,"marginTop",!0)+fn.css(element,"marginBottom",!0):value-=fn.css(element,"paddingTop",!0)+fn.css(element,"paddingBottom",!0)+fn.css(element,"borderTopWidth",!0)+fn.css(element,"borderBottomWidth",!0),value},fn.width=function(element,outer){var value=element.offsetWidth;return outer?value+=fn.css(element,"marginLeft",!0)+fn.css(element,"marginRight",!0):value-=fn.css(element,"paddingLeft",!0)+fn.css(element,"paddingRight",!0)+fn.css(element,"borderLeftWidth",!0)+fn.css(element,"borderRightWidth",!0),value},fn}).provider("$tooltip",function(){var defaults=this.defaults={animation:"am-fade",customClass:"",prefixClass:"tooltip",prefixEvent:"tooltip",container:!1,target:!1,placement:"top",template:"tooltip/tooltip.tpl.html",contentTemplate:!1,trigger:"hover focus",keyboard:!1,html:!1,show:!1,title:"",type:"",delay:0,autoClose:!1,bsEnabled:!0};this.$get=function($window,$rootScope,$compile,$q,$templateCache,$http,$animate,$sce,dimensions,$$rAF,$timeout){function TooltipFactory(element,config){function enterAnimateCallback(){}function leaveAnimateCallback(){return scope.$emit(options.prefixEvent+".hide",$tooltip),_blur&&"focus"===options.trigger?element[0].blur():void destroyTipElement()}function bindTriggerEvents(){var triggers=options.trigger.split(" ");angular.forEach(triggers,function(trigger){"click"===trigger?element.on("click",$tooltip.toggle):"manual"!==trigger&&(element.on("hover"===trigger?"mouseenter":"focus",$tooltip.enter),element.on("hover"===trigger?"mouseleave":"blur",$tooltip.leave),"button"===nodeName&&"hover"!==trigger&&element.on(isTouch?"touchstart":"mousedown",$tooltip.$onFocusElementMouseDown))})}function unbindTriggerEvents(){for(var triggers=options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];"click"===trigger?element.off("click",$tooltip.toggle):"manual"!==trigger&&(element.off("hover"===trigger?"mouseenter":"focus",$tooltip.enter),element.off("hover"===trigger?"mouseleave":"blur",$tooltip.leave),"button"===nodeName&&"hover"!==trigger&&element.off(isTouch?"touchstart":"mousedown",$tooltip.$onFocusElementMouseDown))}}function bindKeyboardEvents(){"focus"!==options.trigger?tipElement.on("keyup",$tooltip.$onKeyUp):element.on("keyup",$tooltip.$onFocusKeyUp)}function unbindKeyboardEvents(){"focus"!==options.trigger?tipElement.off("keyup",$tooltip.$onKeyUp):element.off("keyup",$tooltip.$onFocusKeyUp)}function bindAutoCloseEvents(){$timeout(function(){tipElement.on("click",stopEventPropagation),$body.on("click",$tooltip.hide),_autoCloseEventsBinded=!0},0,!1)}function unbindAutoCloseEvents(){_autoCloseEventsBinded&&(tipElement.off("click",stopEventPropagation),$body.off("click",$tooltip.hide),_autoCloseEventsBinded=!1)}function stopEventPropagation(event){event.stopPropagation()}function getPosition($element){$element=$element||options.target||element;var el=$element[0],elRect=el.getBoundingClientRect();null===elRect.width&&(elRect=angular.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var elPos;return elPos="body"===options.container?dimensions.offset(el):dimensions.position(el),angular.extend({},elRect,elPos)}function getCalculatedOffset(placement,position,actualWidth,actualHeight){var offset,split=placement.split("-");switch(split[0]){case"right":offset={top:position.top+position.height/2-actualHeight/2,left:position.left+position.width};break;case"bottom":offset={top:position.top+position.height,left:position.left+position.width/2-actualWidth/2};break;case"left":offset={top:position.top+position.height/2-actualHeight/2,left:position.left-actualWidth};break;default:offset={top:position.top-actualHeight,left:position.left+position.width/2-actualWidth/2}}if(!split[1])return offset;if("top"===split[0]||"bottom"===split[0])switch(split[1]){case"left":offset.left=position.left;break;case"right":offset.left=position.left+position.width-actualWidth}else if("left"===split[0]||"right"===split[0])switch(split[1]){case"top":offset.top=position.top-actualHeight;break;case"bottom":offset.top=position.top+position.height}return offset}function applyPlacementCss(top,left){tipElement.css({top:top+"px",left:left+"px"})}function destroyTipElement(){clearTimeout(timeout),$tooltip.$isShown&&null!==tipElement&&(options.autoClose&&unbindAutoCloseEvents(),options.keyboard&&unbindKeyboardEvents()),tipScope&&(tipScope.$destroy(),tipScope=null),tipElement&&(tipElement.remove(),tipElement=$tooltip.$element=null)}var $tooltip={},nodeName=element[0].nodeName.toLowerCase(),options=$tooltip.$options=angular.extend({},defaults,config);$tooltip.$promise=fetchTemplate(options.template);var scope=$tooltip.$scope=options.scope&&options.scope.$new()||$rootScope.$new();if(options.delay&&angular.isString(options.delay)){var split=options.delay.split(",").map(parseFloat);options.delay=split.length>1?{show:split[0],hide:split[1]}:split[0]}options.title&&(scope.title=$sce.trustAsHtml(options.title)),scope.$setEnabled=function(isEnabled){scope.$$postDigest(function(){$tooltip.setEnabled(isEnabled)})},scope.$hide=function(){scope.$$postDigest(function(){$tooltip.hide()})},scope.$show=function(){scope.$$postDigest(function(){$tooltip.show()})},scope.$toggle=function(){scope.$$postDigest(function(){$tooltip.toggle()})},$tooltip.$isShown=scope.$isShown=!1;var timeout,hoverState;options.contentTemplate&&($tooltip.$promise=$tooltip.$promise.then(function(template){var templateEl=angular.element(template);return fetchTemplate(options.contentTemplate).then(function(contentTemplate){var contentEl=findElement('[ng-bind="content"]',templateEl[0]);return contentEl.length||(contentEl=findElement('[ng-bind="title"]',templateEl[0])),contentEl.removeAttr("ng-bind").html(contentTemplate),templateEl[0].outerHTML})}));var tipLinker,tipElement,tipTemplate,tipContainer,tipScope;$tooltip.$promise.then(function(template){angular.isObject(template)&&(template=template.data),options.html&&(template=template.replace(htmlReplaceRegExp,'ng-bind-html="')),template=trim.apply(template),tipTemplate=template,tipLinker=$compile(template),$tooltip.init()}),$tooltip.init=function(){options.delay&&angular.isNumber(options.delay)&&(options.delay={show:options.delay,hide:options.delay}),"self"===options.container?tipContainer=element:angular.isElement(options.container)?tipContainer=options.container:options.container&&(tipContainer=findElement(options.container)),bindTriggerEvents(),options.target&&(options.target=angular.isElement(options.target)?options.target:findElement(options.target)),options.show&&scope.$$postDigest(function(){"focus"===options.trigger?element[0].focus():$tooltip.show()})},$tooltip.destroy=function(){unbindTriggerEvents(),destroyTipElement(),scope.$destroy()},$tooltip.enter=function(){return clearTimeout(timeout),hoverState="in",options.delay&&options.delay.show?void(timeout=setTimeout(function(){"in"===hoverState&&$tooltip.show()},options.delay.show)):$tooltip.show()},$tooltip.show=function(){if(options.bsEnabled){scope.$emit(options.prefixEvent+".show.before",$tooltip);var parent,after;options.container?(parent=tipContainer,after=tipContainer[0].lastChild?angular.element(tipContainer[0].lastChild):null):(parent=null,after=element),tipElement&&destroyTipElement(),tipScope=$tooltip.$scope.$new(),tipElement=$tooltip.$element=tipLinker(tipScope,function(){}),tipElement.css({top:"-9999px",left:"-9999px",display:"block",visibility:"hidden"}),options.animation&&tipElement.addClass(options.animation),options.type&&tipElement.addClass(options.prefixClass+"-"+options.type),options.customClass&&tipElement.addClass(options.customClass);var promise=$animate.enter(tipElement,parent,after,enterAnimateCallback);promise&&promise.then&&promise.then(enterAnimateCallback),$tooltip.$isShown=scope.$isShown=!0,safeDigest(scope),$$rAF(function(){$tooltip.$applyPlacement(),tipElement&&tipElement.css({visibility:"visible"})}),options.keyboard&&("focus"!==options.trigger&&$tooltip.focus(),bindKeyboardEvents()),options.autoClose&&bindAutoCloseEvents()}},$tooltip.leave=function(){return clearTimeout(timeout),hoverState="out",options.delay&&options.delay.hide?void(timeout=setTimeout(function(){"out"===hoverState&&$tooltip.hide()},options.delay.hide)):$tooltip.hide()};var _blur;$tooltip.hide=function(blur){if($tooltip.$isShown){scope.$emit(options.prefixEvent+".hide.before",$tooltip),_blur=blur;var promise=$animate.leave(tipElement,leaveAnimateCallback);promise&&promise.then&&promise.then(leaveAnimateCallback),$tooltip.$isShown=scope.$isShown=!1,safeDigest(scope),options.keyboard&&null!==tipElement&&unbindKeyboardEvents(),options.autoClose&&null!==tipElement&&unbindAutoCloseEvents()}},$tooltip.toggle=function(){$tooltip.$isShown?$tooltip.leave():$tooltip.enter()},$tooltip.focus=function(){tipElement[0].focus()},$tooltip.setEnabled=function(isEnabled){options.bsEnabled=isEnabled},$tooltip.$applyPlacement=function(){if(tipElement){var placement=options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||defaults.placement),tipElement.addClass(options.placement);var elementPosition=getPosition(),tipWidth=tipElement.prop("offsetWidth"),tipHeight=tipElement.prop("offsetHeight");if(autoPlace){var originalPlacement=placement,container=options.container?angular.element(document.querySelector(options.container)):element.parent(),containerPosition=getPosition(container);originalPlacement.indexOf("bottom")>=0&&elementPosition.bottom+tipHeight>containerPosition.bottom?placement=originalPlacement.replace("bottom","top"):originalPlacement.indexOf("top")>=0&&elementPosition.top-tipHeight<containerPosition.top&&(placement=originalPlacement.replace("top","bottom")),("right"===originalPlacement||"bottom-left"===originalPlacement||"top-left"===originalPlacement)&&elementPosition.right+tipWidth>containerPosition.width?placement="right"===originalPlacement?"left":placement.replace("left","right"):("left"===originalPlacement||"bottom-right"===originalPlacement||"top-right"===originalPlacement)&&elementPosition.left-tipWidth<containerPosition.left&&(placement="left"===originalPlacement?"right":placement.replace("right","left")),tipElement.removeClass(originalPlacement).addClass(placement)}var tipPosition=getCalculatedOffset(placement,elementPosition,tipWidth,tipHeight);applyPlacementCss(tipPosition.top,tipPosition.left)}},$tooltip.$onKeyUp=function(evt){27===evt.which&&$tooltip.$isShown&&($tooltip.hide(),evt.stopPropagation())},$tooltip.$onFocusKeyUp=function(evt){27===evt.which&&(element[0].blur(),evt.stopPropagation())},$tooltip.$onFocusElementMouseDown=function(evt){evt.preventDefault(),evt.stopPropagation(),$tooltip.$isShown?element[0].blur():element[0].focus()};var _autoCloseEventsBinded=!1;return $tooltip}function safeDigest(scope){scope.$$phase||scope.$root&&scope.$root.$$phase||scope.$digest()}function findElement(query,element){return angular.element((element||document).querySelectorAll(query))}function fetchTemplate(template){return fetchPromises[template]?fetchPromises[template]:fetchPromises[template]=$q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}var trim=String.prototype.trim,isTouch="createTouch"in $window.document,htmlReplaceRegExp=/ng-bind="/gi,$body=angular.element($window.document),fetchPromises={};return TooltipFactory}}).provider("$datepicker",function(){var defaults=this.defaults={animation:"am-fade",prefixClass:"datepicker",placement:"bottom-left",template:"templates/tinkDatePicker.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!1,dateType:"date",dateFormat:"shortDate",modelDateFormat:null,dayFormat:"dd",monthFormat:"MMM",yearFormat:"yyyy",monthTitleFormat:"MMMM yyyy",yearTitleFormat:"yyyy",strictFormat:!1,autoclose:!1,minDate:-1/0,maxDate:+1/0,startView:0,minView:0,startWeek:1,daysOfWeekDisabled:"",iconLeft:"glyphicon glyphicon-chevron-left",iconRight:"glyphicon glyphicon-chevron-right"};this.$get=function($window,$document,$rootScope,$sce,$dateFormatter,datepickerViews,$tooltip,$timeout){function DatepickerFactory(element,controller,config){function updateSelected(el){el.selected=$datepicker.$isSelected(el.date)}function focusElement(){element[0].focus()}var $datepicker=$tooltip(element,angular.extend({},defaults,config)),parentScope=config.scope,options=$datepicker.$options,scope=$datepicker.$scope;options.startView&&(options.startView-=options.minView);var pickerViews=datepickerViews($datepicker);$datepicker.$views=pickerViews.views;var viewDate=pickerViews.viewDate;scope.$mode=options.startView,scope.$iconLeft=options.iconLeft,scope.$iconRight=options.iconRight;var $picker=$datepicker.$views[scope.$mode];scope.$select=function(date){$datepicker.select(date)},scope.$selectPane=function(value){$datepicker.$selectPane(value)},scope.$toggleMode=function(){$datepicker.setMode((scope.$mode+1)%$datepicker.$views.length)},$datepicker.update=function(date){angular.isDate(date)&&!isNaN(date.getTime())&&($datepicker.$date=date,$picker.update.call($picker,date)),$datepicker.$build(!0)},$datepicker.updateDisabledDates=function(dateRanges){options.disabledDateRanges=dateRanges;for(var i=0,l=scope.rows.length;l>i;i++)angular.forEach(scope.rows[i],$datepicker.$setDisabledEl)},$datepicker.select=function(date,keep){angular.isDate(controller.$dateValue)||(controller.$dateValue=new Date(date)),!scope.$mode||keep?(controller.$setViewValue(angular.copy(date)),controller.$render(),options.autoclose&&!keep&&$timeout(function(){$datepicker.hide(!0)})):(angular.extend(viewDate,{year:date.getFullYear(),month:date.getMonth(),date:date.getDate()}),$datepicker.setMode(scope.$mode-1),$datepicker.$build())},$datepicker.setMode=function(mode){scope.$mode=mode,$picker=$datepicker.$views[scope.$mode],$datepicker.$build()},$datepicker.$build=function(pristine){pristine===!0&&$picker.built||(pristine!==!1||$picker.built)&&$picker.build.call($picker)},$datepicker.$updateSelected=function(){for(var i=0,l=scope.rows.length;l>i;i++)angular.forEach(scope.rows[i],updateSelected)},$datepicker.$isSelected=function(date){return $picker.isSelected(date)},$datepicker.$setDisabledEl=function(el){el.disabled=$picker.isDisabled(el.date)},$datepicker.$selectPane=function(value){var steps=$picker.steps,targetDate=new Date(Date.UTC(viewDate.year+(steps.year||0)*value,viewDate.month+(steps.month||0)*value,1));angular.extend(viewDate,{year:targetDate.getUTCFullYear(),month:targetDate.getUTCMonth(),date:targetDate.getUTCDate()}),$datepicker.$build()},$datepicker.$onMouseDown=function(evt){if(evt.preventDefault(),evt.stopPropagation(),isTouch){var targetEl=angular.element(evt.target);"button"!==targetEl[0].nodeName.toLowerCase()&&(targetEl=targetEl.parent()),targetEl.triggerHandler("click")}},$datepicker.$onKeyDown=function(evt){if(/(38|37|39|40|13)/.test(evt.keyCode)&&!evt.shiftKey&&!evt.altKey){if(evt.preventDefault(),evt.stopPropagation(),13===evt.keyCode)return scope.$mode?scope.$apply(function(){$datepicker.setMode(scope.$mode-1)}):$datepicker.hide(!0);$picker.onKeyDown(evt),parentScope.$digest()}};var _init=$datepicker.init;$datepicker.init=function(){return isNative&&options.useNative?(element.prop("type","date"),void element.css("-webkit-appearance","textfield")):(isTouch&&(element.prop("type","text"),element.attr("readonly","true"),element.on("click",focusElement)),void _init())};var _destroy=$datepicker.destroy;$datepicker.destroy=function(){isNative&&options.useNative&&element.off("click",focusElement),_destroy()};var _show=$datepicker.show;$datepicker.show=function(){_show(),$timeout(function(){$datepicker.$element.on(isTouch?"touchstart":"mousedown",$datepicker.$onMouseDown),options.keyboard&&element.on("keydown",$datepicker.$onKeyDown)},0,!1)};var _hide=$datepicker.hide;return $datepicker.hide=function(blur){$datepicker.$isShown&&($datepicker.$element.off(isTouch?"touchstart":"mousedown",$datepicker.$onMouseDown),options.keyboard&&element.off("keydown",$datepicker.$onKeyDown),_hide(blur))},$datepicker}var isNative=(angular.element($window.document.body),/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent)),isTouch="createTouch"in $window.document&&isNative;return defaults.lang||(defaults.lang=$dateFormatter.getDefaultLocale()),DatepickerFactory.defaults=defaults,DatepickerFactory}}).directive("bsDatepicker",function($window,$parse,$q,$dateFormatter,$dateParser,$datepicker){var isNative=($datepicker.defaults,/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent));return{restrict:"EAC",require:"ngModel",link:function(scope,element,attr,controller){function normalizeDateRanges(ranges){return ranges&&ranges.length?ranges:null}function validateAgainstMinMaxDate(parsedDate){if(angular.isDate(parsedDate)){var isMinValid=isNaN(datepicker.$options.minDate)||parsedDate.getTime()>=datepicker.$options.minDate,isMaxValid=isNaN(datepicker.$options.maxDate)||parsedDate.getTime()<=datepicker.$options.maxDate,isValid=isMinValid&&isMaxValid;controller.$setValidity("date",isValid),controller.$setValidity("min",isMinValid),controller.$setValidity("max",isMaxValid),isValid&&(controller.$dateValue=parsedDate)}}function getDateFormattedString(){return!controller.$dateValue||isNaN(controller.$dateValue.getTime())?"":formatDate(controller.$dateValue,options.dateFormat)}var options={scope:scope,controller:controller};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","dateType","dateFormat","modelDateFormat","dayFormat","strictFormat","startWeek","startDate","useNative","lang","startView","minView","iconLeft","iconRight","daysOfWeekDisabled"],function(key){angular.isDefined(attr[key])&&(options[key]=attr[key])}),attr.bsShow&&scope.$watch(attr.bsShow,function(newValue){datepicker&&angular.isDefined(newValue)&&(angular.isString(newValue)&&(newValue=!!newValue.match(/true|,?(datepicker),?/i)),newValue===!0?datepicker.show():datepicker.hide())});var datepicker=$datepicker(element,controller,options);options=datepicker.$options,isNative&&options.useNative&&(options.dateFormat="yyyy-MM-dd");var lang=options.lang,formatDate=function(date,format){return $dateFormatter.formatDate(date,format,lang)},dateParser=$dateParser({format:options.dateFormat,lang:lang,strict:options.strictFormat});angular.forEach(["minDate","maxDate"],function(key){angular.isDefined(attr[key])&&attr.$observe(key,function(newValue){datepicker.$options[key]=dateParser.getDateForAttribute(key,newValue),!isNaN(datepicker.$options[key])&&datepicker.$build(!1),validateAgainstMinMaxDate(controller.$dateValue)})}),scope.$watch(attr.ngModel,function(){datepicker.update(controller.$dateValue)},!0),angular.isDefined(attr.disabledDates)&&scope.$watch(attr.disabledDates,function(disabledRanges,previousValue){disabledRanges=normalizeDateRanges(disabledRanges),previousValue=normalizeDateRanges(previousValue),disabledRanges&&datepicker.updateDisabledDates(disabledRanges)}),controller.$parsers.unshift(function(viewValue){if(!viewValue)return controller.$setValidity("date",!0),null;var parsedDate=dateParser.parse(viewValue,controller.$dateValue);return!parsedDate||isNaN(parsedDate.getTime())?void controller.$setValidity("date",!1):(validateAgainstMinMaxDate(parsedDate),"string"===options.dateType?formatDate(parsedDate,options.modelDateFormat||options.dateFormat):"number"===options.dateType?controller.$dateValue.getTime():"iso"===options.dateType?controller.$dateValue.toISOString():new Date(controller.$dateValue))}),controller.$formatters.push(function(modelValue){var date;return date=angular.isUndefined(modelValue)||null===modelValue?0/0:angular.isDate(modelValue)?modelValue:"string"===options.dateType?dateParser.parse(modelValue,null,options.modelDateFormat):new Date(modelValue),controller.$dateValue=date,getDateFormattedString()}),controller.$render=function(){element.val(getDateFormattedString())},scope.$on("$destroy",function(){datepicker&&datepicker.destroy(),options=null,datepicker=null})}}}).provider("datepickerViews",function(){function split(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays}function mod(n,m){return(n%m+m)%m}this.defaults={dayFormat:"dd",daySplit:7};this.$get=function($dateFormatter,$dateParser,$sce){return function(picker){var scope=picker.$scope,options=picker.$options,lang=options.lang,formatDate=function(date,format){return $dateFormatter.formatDate(date,format,lang)},dateParser=$dateParser({format:options.dateFormat,lang:lang,strict:options.strictFormat}),weekDaysMin=$dateFormatter.weekdaysShort(lang),weekDaysLabels=weekDaysMin.slice(options.startWeek).concat(weekDaysMin.slice(0,options.startWeek)),weekDaysLabelsHtml=$sce.trustAsHtml('<th class="dow text-center">'+weekDaysLabels.join('</th><th class="dow text-center">')+"</th>"),startDate=picker.$date||(options.startDate?dateParser.getDateForAttribute("startDate",options.startDate):new Date),viewDate={year:startDate.getFullYear(),month:startDate.getMonth(),date:startDate.getDate()},views=(6e4*startDate.getTimezoneOffset(),[{format:options.dayFormat,split:7,steps:{month:1},update:function(date,force){!this.built||force||date.getFullYear()!==viewDate.year||date.getMonth()!==viewDate.month?(angular.extend(viewDate,{year:picker.$date.getFullYear(),month:picker.$date.getMonth(),date:picker.$date.getDate()}),picker.$build()):date.getDate()!==viewDate.date&&(viewDate.date=picker.$date.getDate(),picker.$updateSelected())},build:function(){var firstDayOfMonth=new Date(viewDate.year,viewDate.month,1),firstDayOfMonthOffset=firstDayOfMonth.getTimezoneOffset(),firstDate=new Date(+firstDayOfMonth-864e5*mod(firstDayOfMonth.getDay()-options.startWeek,7)),firstDateOffset=firstDate.getTimezoneOffset(),today=(new Date).toDateString();firstDateOffset!==firstDayOfMonthOffset&&(firstDate=new Date(+firstDate+6e4*(firstDateOffset-firstDayOfMonthOffset)));var daysToDraw=$dateFormatter.daysInMonth(viewDate.month+1,viewDate.year)+$dateFormatter.daysBetween(firstDate,firstDayOfMonth);daysToDraw%7!==0&&(daysToDraw+=7-daysToDraw%7);for(var day,days=[],i=0;daysToDraw>i;i++)day=dateParser.daylightSavingAdjust(new Date(firstDate.getFullYear(),firstDate.getMonth(),firstDate.getDate()+i)),days.push({date:day,isToday:day.toDateString()===today,label:formatDate(day,this.format),selected:picker.$date&&this.isSelected(day),muted:day.getMonth()!==viewDate.month,disabled:this.isDisabled(day)});scope.title=formatDate(firstDayOfMonth,options.monthTitleFormat),scope.showLabels=!0,scope.labels=weekDaysLabelsHtml,scope.rows=split(days,this.split),this.built=!0},isSelected:function(date){return picker.$date&&date.getFullYear()===picker.$date.getFullYear()&&date.getMonth()===picker.$date.getMonth()&&date.getDate()===picker.$date.getDate()},isDisabled:function(date){var time=date.getTime();if(time<options.minDate||time>options.maxDate)return!0;if(-1!==options.daysOfWeekDisabled.indexOf(date.getDay()))return!0;if(options.disabledDateRanges)for(var i=0;i<options.disabledDateRanges.length;i++)if(time>=options.disabledDateRanges[i].start&&time<=options.disabledDateRanges[i].end)return!0;return!1},onKeyDown:function(evt){if(picker.$date){var newDate,actualTime=picker.$date.getTime();37===evt.keyCode?newDate=new Date(actualTime-864e5):38===evt.keyCode?newDate=new Date(actualTime-6048e5):39===evt.keyCode?newDate=new Date(actualTime+864e5):40===evt.keyCode&&(newDate=new Date(actualTime+6048e5)),this.isDisabled(newDate)||picker.select(newDate,!0)}}},{name:"month",format:options.monthFormat,split:4,steps:{year:1},update:function(date){this.built&&date.getFullYear()===viewDate.year?date.getMonth()!==viewDate.month&&(angular.extend(viewDate,{month:picker.$date.getMonth(),date:picker.$date.getDate()}),picker.$updateSelected()):(angular.extend(viewDate,{year:picker.$date.getFullYear(),month:picker.$date.getMonth(),date:picker.$date.getDate()}),picker.$build())
},build:function(){for(var month,months=(new Date(viewDate.year,0,1),[]),i=0;12>i;i++)month=new Date(viewDate.year,i,1),months.push({date:month,label:dateParser.getShortMonths(lang)[i],selected:picker.$isSelected(month),disabled:this.isDisabled(month)});scope.title=formatDate(month,options.yearTitleFormat),scope.showLabels=!1,scope.rows=split(months,this.split),this.built=!0},isSelected:function(date){return picker.$date&&date.getFullYear()===picker.$date.getFullYear()&&date.getMonth()===picker.$date.getMonth()},isDisabled:function(date){var lastDate=+new Date(date.getFullYear(),date.getMonth()+1,0);return lastDate<options.minDate||date.getTime()>options.maxDate},onKeyDown:function(evt){if(picker.$date){var actualMonth=picker.$date.getMonth(),newDate=new Date(picker.$date);37===evt.keyCode?newDate.setMonth(actualMonth-1):38===evt.keyCode?newDate.setMonth(actualMonth-4):39===evt.keyCode?newDate.setMonth(actualMonth+1):40===evt.keyCode&&newDate.setMonth(actualMonth+4),this.isDisabled(newDate)||picker.select(newDate,!0)}}},{name:"year",format:options.yearFormat,split:4,steps:{year:12},update:function(date,force){!this.built||force||parseInt(date.getFullYear()/20,10)!==parseInt(viewDate.year/20,10)?(angular.extend(viewDate,{year:picker.$date.getFullYear(),month:picker.$date.getMonth(),date:picker.$date.getDate()}),picker.$build()):date.getFullYear()!==viewDate.year&&(angular.extend(viewDate,{year:picker.$date.getFullYear(),month:picker.$date.getMonth(),date:picker.$date.getDate()}),picker.$updateSelected())},build:function(){for(var year,firstYear=viewDate.year-viewDate.year%(3*this.split),years=[],i=0;12>i;i++)year=new Date(firstYear+i,0,1),years.push({date:year,label:formatDate(year,this.format),selected:picker.$isSelected(year),disabled:this.isDisabled(year)});scope.title=years[0].label+"-"+years[years.length-1].label,scope.showLabels=!1,scope.rows=split(years,this.split),this.built=!0},isSelected:function(date){return picker.$date&&date.getFullYear()===picker.$date.getFullYear()},isDisabled:function(date){var lastDate=+new Date(date.getFullYear()+1,0,0);return lastDate<options.minDate||date.getTime()>options.maxDate},onKeyDown:function(evt){if(picker.$date){var actualYear=picker.$date.getFullYear(),newDate=new Date(picker.$date);37===evt.keyCode?newDate.setYear(actualYear-1):38===evt.keyCode?newDate.setYear(actualYear-4):39===evt.keyCode?newDate.setYear(actualYear+1):40===evt.keyCode&&newDate.setYear(actualYear+4),this.isDisabled(newDate)||picker.select(newDate,!0)}}}]);return{views:options.minView?Array.prototype.slice.call(views,options.minView):views,viewDate:viewDate}}}}).service("$dateFormatter",function($locale,dateFilter,dateParser){function splitTimeFormat(format){return/(h+)([:\.])?(m+)[ ]?(a?)/i.exec(format).slice(1)}this.getDefaultLocale=function(){return $locale.id},this.getDatetimeFormat=function(format){return $locale.DATETIME_FORMATS[format]||format},this.weekdaysShort=function(){var Weekarray;switch((new Date).getDay()){case"NL":default:Weekarray="Zo,Ma,Di,Woe,Do,Vri,Zat".split(",")}return Weekarray},this.daysInMonth=function(month,year){return new Date(year,month,0).getDate()},this.daysBetween=function(first,last){return Math.round(Math.abs((first.getTime()-last.getTime())/864e5))},this.hoursFormat=function(timeFormat){return splitTimeFormat(timeFormat)[0]},this.minutesFormat=function(timeFormat){return splitTimeFormat(timeFormat)[2]},this.timeSeparator=function(timeFormat){return splitTimeFormat(timeFormat)[1]},this.showAM=function(timeFormat){return!!splitTimeFormat(timeFormat)[3]},this.formatDate=function(date,format){return dateParser.format(date,format)}}).provider("$dateParser",function(){function ParseDate(){this.year=1970,this.month=0,this.day=1,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0}function noop(){}function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}function indexOfCaseInsensitive(array,value){for(var len=array.length,str=value.toString().toLowerCase(),i=0;len>i;i++)if(array[i].toLowerCase()===str)return i;return-1}ParseDate.prototype.setMilliseconds=function(value){this.milliseconds=value},ParseDate.prototype.setSeconds=function(value){this.seconds=value},ParseDate.prototype.setMinutes=function(value){this.minutes=value},ParseDate.prototype.setHours=function(value){this.hours=value},ParseDate.prototype.getHours=function(){return this.hours},ParseDate.prototype.setDate=function(value){this.day=value},ParseDate.prototype.setMonth=function(value){this.month=value},ParseDate.prototype.setFullYear=function(value){this.year=value},ParseDate.prototype.fromDate=function(value){return this.year=value.getFullYear(),this.month=value.getMonth(),this.day=value.getDate(),this.hours=value.getHours(),this.minutes=value.getMinutes(),this.seconds=value.getSeconds(),this.milliseconds=value.getMilliseconds(),this},ParseDate.prototype.toDate=function(){return new Date(this.year,this.month,this.day,this.hours,this.minutes,this.seconds,this.milliseconds)};var proto=ParseDate.prototype,defaults=this.defaults={format:"shortDate",strict:!1};this.$get=function($locale,dateFilter){var DateParserFactory=function(config){function setMapForFormat(format){var i,keys=Object.keys(setFnMap),map=[],sortedMap=[],clonedFormat=format;for(i=0;i<keys.length;i++)if(format.split(keys[i]).length>1){var index=clonedFormat.search(keys[i]);format=format.split(keys[i]).join(""),setFnMap[keys[i]]&&(map[index]=setFnMap[keys[i]])}return angular.forEach(map,function(v){v&&sortedMap.push(v)}),sortedMap}function escapeReservedSymbols(text){return text.replace(/\//g,"[\\/]").replace("/-/g","[-]").replace(/\./g,"[.]").replace(/\\s/g,"[\\s]")}function regExpForFormat(format){var i,keys=Object.keys(regExpMap),re=format;for(i=0;i<keys.length;i++)re=re.split(keys[i]).join("${"+i+"}");for(i=0;i<keys.length;i++)re=re.split("${"+i+"}").join("("+regExpMap[keys[i]]+")");return format=escapeReservedSymbols(format),new RegExp("^"+re+"$",["i"])}var regex,setMap,options=angular.extend({},defaults,config),$dateParser={},regExpMap={sss:"[0-9]{3}",ss:"[0-5][0-9]",s:options.strict?"[1-5]?[0-9]":"[0-9]|[0-5][0-9]",mm:"[0-5][0-9]",m:options.strict?"[1-5]?[0-9]":"[0-9]|[0-5][0-9]",HH:"[01][0-9]|2[0-3]",H:options.strict?"1?[0-9]|2[0-3]":"[01]?[0-9]|2[0-3]",hh:"[0][1-9]|[1][012]",h:options.strict?"[1-9]|1[012]":"0?[1-9]|1[012]",a:"AM|PM",EEEE:$locale.DATETIME_FORMATS.DAY.join("|"),EEE:$locale.DATETIME_FORMATS.SHORTDAY.join("|"),dd:"0[1-9]|[12][0-9]|3[01]",d:options.strict?"[1-9]|[1-2][0-9]|3[01]":"0?[1-9]|[1-2][0-9]|3[01]",MMMM:$locale.DATETIME_FORMATS.MONTH.join("|"),MMM:$locale.DATETIME_FORMATS.SHORTMONTH.join("|"),MM:"0[1-9]|1[012]",M:options.strict?"[1-9]|1[012]":"0?[1-9]|1[012]",yyyy:"[1]{1}[0-9]{3}|[2]{1}[0-9]{3}",yy:"[0-9]{2}",y:options.strict?"-?(0|[1-9][0-9]{0,3})":"-?0*[0-9]{1,4}"},setFnMap={sss:proto.setMilliseconds,ss:proto.setSeconds,s:proto.setSeconds,mm:proto.setMinutes,m:proto.setMinutes,HH:proto.setHours,H:proto.setHours,hh:proto.setHours,h:proto.setHours,EEEE:noop,EEE:noop,dd:proto.setDate,d:proto.setDate,a:function(value){var hours=this.getHours()%12;return this.setHours(value.match(/pm/i)?hours+12:hours)},MMMM:function(value){return this.setMonth(indexOfCaseInsensitive($locale.DATETIME_FORMATS.MONTH,value))},MMM:function(value){return this.setMonth(indexOfCaseInsensitive($locale.DATETIME_FORMATS.SHORTMONTH,value))},MM:function(value){return this.setMonth(1*value-1)},M:function(value){return this.setMonth(1*value-1)},yyyy:proto.setFullYear,yy:function(value){return this.setFullYear(2e3+1*value)},y:proto.setFullYear};return $dateParser.init=function(){$dateParser.$format=$locale.DATETIME_FORMATS[options.format]||options.format,regex=regExpForFormat($dateParser.$format),setMap=setMapForFormat($dateParser.$format)},$dateParser.isValid=function(date){return angular.isDate(date)?!isNaN(date.getTime()):regex.test(date)},$dateParser.parse=function(value,baseDate,format){format&&(format=$locale.DATETIME_FORMATS[format]||format),angular.isDate(value)&&(value=dateFilter(value,format||$dateParser.$format));var formatRegex=format?regExpForFormat(format):regex,formatSetMap=format?setMapForFormat(format):setMap,matches=formatRegex.exec(value);if(!matches)return!1;for(var date=(new ParseDate).fromDate(baseDate&&!isNaN(baseDate.getTime())?baseDate:new Date(1970,0,1,0)),i=0;i<matches.length-1;i++)formatSetMap[i]&&formatSetMap[i].call(date,matches[i+1]);return date.toDate()},$dateParser.getDateForAttribute=function(key,value){var date;if("today"===value){var today=new Date;date=new Date(today.getFullYear(),today.getMonth(),today.getDate()+("maxDate"===key?1:0),0,0,0,"minDate"===key?0:-1)}else date=angular.isString(value)&&value.match(/^".+"$/)?new Date(value.substr(1,value.length-2)):isNumeric(value)?new Date(parseInt(value,10)):angular.isString(value)&&0===value.length?"minDate"===key?-1/0:+1/0:new Date(value);return date},$dateParser.getTimeForAttribute=function(key,value){var time;return time="now"===value?(new Date).setFullYear(1970,0,1):angular.isString(value)&&value.match(/^".+"$/)?new Date(value.substr(1,value.length-2)).setFullYear(1970,0,1):isNumeric(value)?new Date(parseInt(value,10)).setFullYear(1970,0,1):angular.isString(value)&&0===value.length?"minTime"===key?-1/0:+1/0:$dateParser.parse(value,new Date(1970,0,1,0))},$dateParser.daylightSavingAdjust=function(date){return date?(date.setHours(date.getHours()>12?date.getHours()+2:0),date):null},$dateParser.init(),$dateParser};return DateParserFactory}}),angular.module("tink.datepickerRange",["tink.dateHelper","tink.safeApply"]).directive("tinkDatepickerRange",function($q,$templateCache,$http,$compile,calView,dateParser,$sce,$compile,dateParser,$window,safeApply){return{restrict:"E",replace:!0,templateUrl:"templates/tinkDatePickerRangeInputs.html",scope:{firstDate:"=",lastDate:"="},link:function(scope,element){function buildView(){$directive.tbody.firstDateElem=element.find("tbody")[0],$directive.tbody.lastDateElem=element.find("tbody")[1];var htmlFirst=calView.createMonthDays($directive.viewDate,scope.firstDate,scope.lastDate);angular.element($directive.tbody.firstDateElem).replaceWith($compile(htmlFirst)(scope));var copyViewDate=new Date($directive.viewDate);copyViewDate.setMonth(copyViewDate.getMonth()+1),scope.firstTitle=dateParser.format($directive.viewDate,"mmmm yyyy"),scope.lastTitle=dateParser.format(copyViewDate,"mmmm yyyy");var htmlLast=calView.createMonthDays(copyViewDate,scope.firstDate,scope.lastDate);angular.element($directive.tbody.lastDateElem).replaceWith($compile(htmlLast)(scope))}function nextMonth(){$directive.viewDate.setMonth($directive.viewDate.getMonth()+1),setViewDate($directive.viewDate)}function prevMonth(){$directive.viewDate.setMonth($directive.viewDate.getMonth()-1),setViewDate($directive.viewDate)}function setViewDate(viewDate){if(angular.isDate(viewDate)&&null!==viewDate)if(angular.isDate(viewDate)){var hulpDate=new Date(viewDate.getTime());hulpDate.setMonth(hulpDate.getMonth()-1),dateParser.isSameMonth(viewDate,$directive.viewDate)||dateParser.isSameMonth(hulpDate,$directive.viewDate)||($directive.viewDate=new Date(viewDate)),buildView()}else console.logerror("Wrong date")}function haalTemplateOp(template){return fetchPromises[template]?fetchPromises[template]:fetchPromises[template]=$q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}function init(){isTouch&&(angular.element($directive.focused.firstDateElem).attr("readonly","true"),angular.element($directive.focused.lastDateElem).attr("readonly","true")),bindEvents()}function $onMouseDown(evt){if("INPUT"===evt.target.nodeName?(evt.target.focus(),isTouch&&(evt.preventDefault(),evt.stopPropagation())):(evt.preventDefault(),evt.stopPropagation()),isTouch){var targetEl=angular.element(evt.target);"button"!==targetEl[0].nodeName.toLowerCase()&&(targetEl=targetEl.parent()),targetEl.triggerHandler("click")}}function hide(evt){evt.relatedTarget&&"INPUT"===evt.relatedTarget.nodeName||(templateElem.css({display:"none"}),$directive.open=!1,$directive.focusedModel=null)}function bindEvents(){element.bind("click",function(evt){evt.stopPropagation()}),element.bind("touchstart mousedown",$onMouseDown),angular.element($directive.focused.firstDateElem).on("blur",hide),angular.element($directive.focused.lastDateElem).on("blur",hide),angular.element($directive.focused.firstDateElem).on("focus",function(){$directive.focusedModel="firstDateElem",safeApply(scope,show)}),angular.element($directive.focused.lastDateElem).on("focus",function(){$directive.focusedModel="lastDateElem",safeApply(scope,show)})}function show(){$directive.open||(setViewDate(null!==$directive.focusedModel?"firstDateElem"===$directive.focusedModel&&angular.isDate(scope.firstDate)?scope.firstDate:"firstDateElem"===$directive.focusedModel&&angular.isDate(scope.lastDate)?scope.lastDate:"lastDateElem"===$directive.focusedModel&&angular.isDate(scope.lastDate)?scope.lastDate:"lastDateElem"===$directive.focusedModel&&angular.isDate(scope.firstDate)?scope.firstDate:new Date:new Date),$directive.open=!0,templateElem.css({display:"block"}))}var isNative=/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent),isTouch="createTouch"in $window.document&&isNative,dayLabels=["ma","di","wo","do","vr","za","zo"];scope.dayLabels=$sce.trustAsHtml("<th>"+dayLabels.join("</th><th>")+"</th>"),scope.$watch("firstDate",function(newDate,oldDate){var date;if(newDate!==oldDate&&angular.isDefined(newDate)&&null!==newDate){if(angular.isDate(newDate))date=newDate,setViewDate(newDate);else try{date=dateParser.getDate(newDate,config.dateFormat),scope.firstDate=date}catch(e){scope.firstDate=null}scope.firstDateModel=dateParser.format(date,config.dateFormat)}}),scope.$watch("lastDate",function(newDate,oldDate){if(newDate!==oldDate&&angular.isDefined(newDate)&&null!==newDate){if(angular.isDate(newDate))setViewDate(newDate);else try{var date=dateParser.getDate(newDate,config.dateFormat);scope.lastDate=date,setViewDate(date)}catch(e){scope.lastDate=null}scope.lastDateModel=dateParser.format(scope.lastDate,config.dateFormat)}}),scope.$watch("firstDateModel",function(date){scope.firstDate=date}),scope.$watch("lastDateModel",function(date){scope.lastDate=date});var templateElem,config={dateFormat:"dd/mm/yyyy"},$directive={open:!1,focused:{firstDateElem:element[0].children[0],lastDateElem:element[0].children[1]},tbody:{firstDateElem:null,lastDateElem:null},focusedModel:null,selectedDates:{first:scope.firstDate,last:scope.lastDate},valid:{firstDateElem:!1,lastDateElem:!1},mouse:0,viewDate:null,hardCodeFocus:!1},fetchPromises={},promise=haalTemplateOp("templates/tinkDatePickerRange.html");promise.then(function(template){angular.isObject(template)&&(template=template.data);String.prototype.trim.apply(template);templateElem=$compile(template),templateElem=templateElem(scope,function(){}),templateElem.css({display:"block",position:"absolute",display:"none"}),element.append(templateElem),init()}),scope.$select=function(el){var date=dateParser.getDate(el,"yyyy/mm/dd");null!==$directive.focusedModel&&("firstDateElem"===$directive.focusedModel?(scope.firstDate=date,scope.lastDate||($directive.hardCodeFocus=!0,$directive.focused.lastDateElem.focus())):"lastDateElem"===$directive.focusedModel&&(scope.lastDate=date,scope.firstDate||($directive.hardCodeFocus=!0,$directive.focused.firstDateElem.focus())))},scope.$selectPane=function(value){value?nextMonth():prevMonth()},element.on("mouseleave",function(){$directive.mouse=0}),element.on("mouseenter",function(){$directive.mouse=1})}}}),angular.module("tink.validDate",["tink.dateHelper","tink.safeApply"]).directive("tinkValidDate",["$timeout","$filter","dateParser","safeApply",function($timeout,$filter,dateParser,safeApply){return{require:"ngModel",require:"?ngModel",priority:99,link:function($scope,$element,$attrs,ctrl){function validFormat(date,format){if(angular.isDefined(date)&&null!==date){if(10!==date.length)return!1;var date=dateParser.getDate(date,format);return"INVALID DATE"!==date?!0:!1}}function checkForValid(viewValue){return ctrl.$setValidity("date",validFormat(viewValue,format)),viewValue}var format=$attrs.format;$element.unbind("input").unbind("keydown").unbind("change"),$element.bind("blur",function(){safeApply($scope,function(){ctrl.$setViewValue(checkForValid($element.val(),format)?$element.val():null)})}),ctrl.$formatters.push(checkForValid),ctrl.$parsers.unshift(checkForValid)}}}]),angular.module("tink.dateHelper",[]),angular.module("tink.dateHelper").factory("dateParser",function(){function stringToDate(_date,_format){var _delimiter;-1!==_format.indexOf("/")?_delimiter="/":-1!==_format.indexOf("-")?_delimiter="-":-1!==_format.indexOf(".")&&(_delimiter=".");var formatLowerCase=_format.toLowerCase(),formatItems=formatLowerCase.split(_delimiter),dateItems=_date.split(_delimiter),monthIndex=formatItems.indexOf("mm"),dayIndex=formatItems.indexOf("dd"),yearIndex=formatItems.indexOf("yyyy"),month=parseInt(dateItems[monthIndex]);month-=1;var formatedDate=new Date(dateItems[yearIndex],month,dateItems[dayIndex]);return formatedDate}var nl={DAY:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],MONTH:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],SHORTDAY:["zo","ma","di","wo","do","vr","za"],SHORTMONTH:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."]},dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){for(val=String(val),len=len||2;val.length<len;)val="0"+val;return val};return function(date,mask,utc,lang){var dF=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(date)||/\d/.test(date)||(mask=date,date=void 0),date=date?new Date(date):new Date,isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]).toLowerCase(),"UTC:"==mask.slice(0,4)&&(mask=mask.slice(4),utc=!0);var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:lang.SHORTDAY[D],dddd:lang.DAY[D],m:m+1,mm:pad(m+1),mmm:lang.SHORTMONTH[m],mmmm:lang.MONTH[m],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:12>H?"a":"p",tt:12>H?"am":"pm",T:12>H?"A":"P",TT:12>H?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(100*Math.floor(Math.abs(o)/60)+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();return dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"d/m/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},{dateBeforeOther:function(first,last){return new Date(first).getTime()>new Date(last).getTime()?!0:!1},splitRow:function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},daysBetween:function(first,last){return Math.round(Math.abs((first.getTime()-last.getTime())/864e5))},isSameDate:function(a,b){return angular.isDate(a)&&angular.isDate(b)?(a.setHours(0,0,0,0),b.setHours(0,0,0,0),a.getTime()===b.getTime()):!1},isSameMonth:function(a,b){return angular.isDate(a)&&angular.isDate(b)?(a.setHours(0,0,0,0),b.setHours(0,0,0,0),a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()):!1},getDate:function(date,format){return stringToDate(date,format)},daysInMonth:function(date){return new Date(date.getYear(),date.getMonth()+1,0).getDate()},format:function(date,format){return dateFormat(date,format,null,nl)},getShortDays:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.SHORTDAY}},getShortMonths:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.SHORTMONTH}},getDays:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.DAY}},getMonths:function(lang){switch(lang!==angular.isDefined(lang)&&(lang=""),lang.toLowerCase()){case"nl":default:return nl.MONTH}}}}).factory("safeApply",[function(){return function($scope,fn){var phase=$scope.$root.$$phase;"$apply"==phase||"$digest"==phase?fn&&$scope.$eval(fn):fn?$scope.$apply(fn):$scope.$apply()}}]).factory("calView",function(dateParser){function isSameDate(a,b){return angular.isDate(a)&&angular.isDate(b)?(a.setHours(0,0,0,0),b.setHours(0,0,0,0),a.getTime()===b.getTime()):!1}function inRange(date,first,last){return angular.isDate(first)&&angular.isDate(last)&&angular.isDate(date)?(date.setHours(0,0,0,0),first.setHours(0,0,0,0),last.setHours(0,0,0,0),date>first&&last>date?!0:!1):!1}function mod(n,m){var mod=(n%m+m)%m;return mod}function callCullateData(date){var year=date.getFullYear(),month=date.getMonth(),firstDayOfMonth=new Date(year,month,1),firstDayOfWeek=new Date(+firstDayOfMonth-864e5*mod(firstDayOfMonth.getDay()-1,7)),offsetDayOfMonth=firstDayOfMonth.getTimezoneOffset(),offsetDayOfweek=firstDayOfWeek.getTimezoneOffset();offsetDayOfMonth!==offsetDayOfweek&&(firstDayOfWeek=new Date(+firstDayOfWeek+6e4*(offsetDayOfweek-offsetDayOfMonth)));var daysToDraw=dateParser.daysInMonth(date)+dateParser.daysBetween(firstDayOfWeek,firstDayOfMonth);return daysToDraw%7!==0&&(daysToDraw+=7-daysToDraw%7),{days:daysToDraw,firstDay:firstDayOfWeek}}function createLabels(date,firstRange,lastRange){var label="",cssClass="";return null!==label&&angular.isDate(date)?(label=date.getDate(),isSameDate(date,firstRange)||isSameDate(date,lastRange)?cssClass="btn-primary":inRange(date,firstRange,lastRange)?cssClass="btn-info":isSameDate(date,new Date)&&(cssClass="btn-warning"),"<td><button ng-click=\"$select('"+date.getFullYear()+"/"+(date.getMonth()+1)+"/"+date.getDate()+'\')" class="'+cssClass+'"><span>'+label+"</span></button></td>"):"<td></td>"}return{createMonthDays:function(date,firstRange,lastRange){for(var label,domElem="",monthCall=callCullateData(date),tr="<tr>",i=0;i<monthCall.days;i++){var day=new Date(monthCall.firstDay.getFullYear(),monthCall.firstDay.getMonth(),monthCall.firstDay.getDate()+i);label=day.getMonth()!==date.getMonth()?createLabels(null):createLabels(day,firstRange,lastRange),tr+=label,(i+1)%7===0&&(tr+="</tr>",domElem+=tr,tr="<tr>")}return domElem='<tbody id="secondCal">'+domElem+"</tbody>"}}}),angular.module("tink.safeApply",[]).factory("safeApply",[function(){return function($scope,fn){var phase=$scope.$root.$$phase;"$apply"==phase||"$digest"==phase?fn&&$scope.$eval(fn):fn?$scope.$apply(fn):$scope.$apply()}}]);