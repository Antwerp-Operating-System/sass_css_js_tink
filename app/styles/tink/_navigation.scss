/**
 * Navigation
 * --------------------------------------------------
 * - top navigation
 * - off-canvas nav
 * - nav states
 */



/**
 * Default behaviour is that there is a fixed top-nav,
 * so we need to 'fix' the body's padding
 */
body {
  padding-top: rem($top-nav-height);

  // If the top-nav for some reason needs to scroll with the page
  &.has-relative-top-nav {
    padding-top: 0;

    .top-nav {
      position: relative;
    }
  }
}




/**
 * Top navigation
 */

.top-nav {
  background-color: $top-nav-bg-color;
  line-height: rem($top-nav-height);
  overflow: auto;
  position: fixed;
  top: 0;
  width: 100%;
  z-index: layer('top-nav');
}

ul.top-nav-branding,
ul.top-nav-left,
ul.top-nav-right {
  @extend .list-inline;
  margin: 0;

  li {
    padding: 0;
  }

  a {
    color: $top-nav-link-color;
    outline: none;
    text-decoration: none;
    display: inline-block;
    line-height: rem($top-nav-height - $top-nav-padding);
    margin: rem(($top-nav-padding / 2) 0);
    padding: rem(0 $top-nav-padding);

    &:hover,
    &:active,
    &:focus {
      color: $top-nav-link-hover-color;
    }

    &:focus {
      box-shadow: 0 0 0 2px rgba($brand-light, .5);
    }
  }
}

ul.top-nav-branding {
  float: left;

  li {
    float: left;

    &:first-child {
      a {
        float: left;
        margin: rem(0 $top-nav-padding 0 0);
        padding: 0;
      }
    }
  }

  img {
    float: left;
    height: rem($top-nav-height);
    width: auto;
  }

  h1 {
    font-size: rem($font-size-base);
    font-weight: 700;
    line-height: rem($top-nav-height);
    margin: 0;
  }
}

section.top-nav-section {
  position: relative;
  width: auto;
}

ul.top-nav-left {
  float: left;
  margin-left: rem($top-nav-padding / 2);
}

ul.top-nav-right {
  float: right;
  margin-right: rem($top-nav-padding / 2);
}




/**
 * Sidenav
 */

.nav-left {
  background: $nav-left-bg-color;
  bottom: 0;
  left: 0;
  overflow: auto;
  position: fixed;
  top: rem($top-nav-height);
  transform: translate(rem(-$nav-left-width), 0);
  transition: transform $animation-speed linear;
  width: rem($nav-left-width);
  z-index: layer('side-nav');
  -webkit-overflow-scrolling: touch;
  -webkit-overflow-scrolling: -blackberry-touch;

  @include mq($screen-sm) {
    transform: translate(0, 0);
  }

  &:before {
    background: rgba(0, 0, 0, .12);
    bottom: 0;
    content: '';
    height: 100%;
    pointer-events: none;
    position: absolute;
    right: 0;
    top: 0;
    width: 2px;
    z-index: layer("pseudo");
  }

  ul {
    @extend .list-unstyled;
  }

  > ul {
    overflow: visible;
    -webkit-backface-visibility: hidden;
    -webkit-transform-style: preserve-3d;

    > li {
      display: block;
      float: left;
      overflow: hidden;
      position: relative;
      transition: max-height $animation-speed linear;
      width: 100%;
      -webkit-backface-visibility: hidden;
      -webkit-transform-style: preserve-3d;

      &:last-child {
        border-bottom: 1px solid $nav-left-border-color;
      }

      &:hover,
      &:active,
      &:focus {
        > a {
          > i {
            color: $white;

            .icon-bg {
              transform: translate(0, 0);
              // z-index: layer('cellar');
            }
          }
        }
      }

      &.active {
        > a {
          background: rgba(0, 0, 0, .05);

          > i {
            color: $white;

            .icon-bg {
              transform: translate(0, 0);
              // z-index: layer('cellar');
            }
          }
        }

        ul {
          max-height: rem(500);
        }

        li {
          &.active {
            > a {
              background: rgba(0, 0, 0, .05);
            }
          }
        }
      }

      // &.open {
      //   ul {
      //     max-height: rem(1000);
      //   }
      // }

      a {
        color: $nav-left-link-color;
        display: table;
        padding: rem(10 10 10 0);
        position: relative;
        text-decoration: none;
        width: 100%;

        &:hover,
        &:active,
        &:focus {
          background: rgba(0, 0, 0, .05);
        }

        > span {
          display: table-cell;
          padding: rem(0 0 0 10);
          vertical-align: middle;
        }
      }

      > a {
        background-color: $nav-left-link-background-color;
        border-top: 1px solid $nav-left-border-color;
        min-height: rem($nav-left-item-height);
        padding: rem(14 0 14 0);
      }

      i {
        display: table-cell;
        padding-top: rem(4);
        position: relative;
        text-align: center;
        vertical-align: top;
        width: rem($nav-left-item-height);
        z-index: layer('base');

        .icon-bg {
          background: linear-gradient(135deg, $brand 0%, $brand-light 100%);
          // background: $panel-default-heading-bg;
          bottom: rem(-14);
          left: 0;
          position: absolute;
          top: rem(-14);
          transform: translate(rem(-$nav-left-item-height + 3px), 0);
          transition: transform $animation-speed linear;
          width: rem($nav-left-item-height);
          z-index: layer('cellar');
        }
      }
    }

    ul {
      background: $body-bg;
      max-height: 0;
      transition: max-height ($animation-speed * 3) linear;
    }
  }
}

// Behaviour!
html.sidenav-open {

  body {
    // height: 100%;
    overflow-x: hidden;
    // position: absolute;
    // width: 100%;
  }

  @include mq($screen-sm, "max") {
    .main-content {
      transform: translate($nav-left-width, 0);
    }
    .nav-left {
      transform: translate(0, 0);
    }
  }

  @include mq($screen-sm) {

    .main-content {
      padding-left: rem($nav-left-item-height);
    }
    .nav-left {
      overflow: visible;
      width: rem($nav-left-item-height);

      > ul {
        > li {
          overflow: visible;

          ul {
            background: $body-bg;
            border: solid rgba(0, 0, 0, .12);
            border-width: 2px 2px 2px 0;
            display: none;
            height: auto;
            max-height: rem(500);
            position: absolute;
            left: rem($nav-left-item-height);
            top: 0;
            width: rem($nav-left-width);
            z-index: layer(side-nav);
          }

          &:hover,
          &:active,
          &:focus {
            ul {
              display: block;
            }
          }

          > a {

            > span {
              display: none;
            }
          }
        }
      }
    }
  }
}